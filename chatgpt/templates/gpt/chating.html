{% extends "layout.html" %}
{% load static %}
{% block title %}  
    QA_chatbot
{% endblock %}
{% block content %}
    <link rel="stylesheet" href="{% static 'gtp/chat_style.css' %}">
    {% comment %} <script src="https://kit.fontawesome.com/61592b64c9.js" crossorigin="anonymous"></script> {% endcomment %}

    <div class="chat-container">
        <div class="wrap">
            {% for message in conversation %}
                {% if forloop.counter|divisibleby:2 %}
                    <div class="chat ch1">
                        <div class="icon"><i class="fa-solid fa-user"></i></div>
                        <div class="textbox">{{ message.bot }}</div>
                    </div>
                {% else %}
                    <div class="chat ch2">
                        <div class="icon"><i class="fa-solid fa-user"></i></div>
                        <div class="textbox">{{ message.user }}</div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>
    <div class="input-section">
        <form id="chat-form" action="chating" method="post" enctype="application/x-www-form-urlencoded">
            {% csrf_token %}
            <div class="input-box">
                {% comment %} <label for="question" class="sr-only">chatgtp에게 요청하기</label> {% endcomment %}
                <textarea id="question" name="question" rows="3" required></textarea>
                <button id="text-button" type="submit">질문</button>
            </div>
        </form>
        <form action="{% url 'chatgpt:reset' %}" method="post">
            <button type="submit" id="reset-button">대화 초기화</button>
            {% csrf_token %}
        </form>
        <a href="{% url 'root' %}" id="home-button"><i class="fas fa-home"></i> Home</a>
    </div>

    <script>
        document.getElementById('question').addEventListener('keydown', function(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                document.getElementById('chat-form').submit();
            }
        });
    </script>
{% endblock %}